Modified version (beyond snapshot_1)